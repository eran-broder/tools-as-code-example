# Tools as code exmple

This is a simple example of using tools in a code environment
## Setup

1. Install dependencies:
   ```
   npm install
   ```

2. Set your ANTHROPIC_API_KEY in the .env file

3. Run the example:
   ```
   npx ts-node src/index.ts
   ```

# What is the idea?
How to save BIG on tokens when running tool based agents

for the past several weeks I have completely abandoned traditional tool_calls in favor of a new method

let say we have two tools:
- getCurrentUserId(): string => returns the current user id
- getUserPhoneNumber(input: {userId: string}): string => returns the phone number of a user
and I give the agent the following task:
"what is the phone number of the current user?"

a simple agent with the tools will "charge" you like this:
⏰Step 1:
Input: 
💰 the task
Output:
💰 call the tool to get the user id

⏰Step 2:
Input:
💰 tokens for the task 
💰 call the tool to get the user id
💰 the user id 
Output:
💰 call the tool to get the phone number

⏰Step 3:
Input:
💰 tokens for the task 
💰 call the tool to get the user id
💰 the user id 
💰 call the tool to get the phone number
Output:
💰 the phone number (BUT as a tool result)

⏰Step 4:
Input:
💰 tokens for the task 
💰 call the tool to get the user id
💰 the user id 
💰 call the tool to get the phone number
💰 the phone number (BUT as a tool result)
Output:
💰 A nice message with the phone number

Time cost : 4x⏰
Total cost 17x💰

My new approach:
⏰Step 1:
Input: 
💰 the task
Output:
💰 run the code that takes care of everything

Time cost : 1x⏰
Total cost 2x💰

How does it work?
insted of an array of tools that looks like this:
[getCurrentUserTool, getUserPhoneNumberTool]
I send this:
wrapWithExecutionScope([getCurrentUserTool, getUserPhoneNumberTool])

And my tool will run the following code that was generated by the LLM iteself:
const userId = await tools.getCurrentUserId(); 
const phoneNumber = await tools.getUserPhoneNumber({ userId }); 
await tools.provideAnswer({ answer: phoneNumber === null ? 
"No phone number found for the current user" : 
`The phone number is: ${phoneNumber}` }); 
return phoneNumber;